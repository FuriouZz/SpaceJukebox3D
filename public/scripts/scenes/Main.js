var __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
  __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

SPACE.MainScene = (function(_super) {
  __extends(MainScene, _super);

  MainScene.prototype.playlist = null;

  MainScene.prototype.current = null;

  function MainScene(bg) {
    this._whileplaying = __bind(this._whileplaying, this);
    this._eTrackOnAdd = __bind(this._eTrackOnAdd, this);
    var middlePoint;
    MainScene.__super__.constructor.call(this, bg);
    middlePoint = new PIXI.Point(window.innerWidth * .5, window.innerHeight * .5);
    this.eq = new SPACE.Equalizer(middlePoint, {
      minLength: 0,
      maxLength: 200,
      radius: 250
    });
    this.addChild(this.eq);
    this.sc = new SPACE.SoundCloud(SPACE.SOUNDCLOUD.id);
    this._events();
    this.jukebox = new SPACE.Jukebox();
    this.jukebox.whileplaying = this._whileplaying;
  }

  MainScene.prototype._events = function() {
    return document.addEventListener(JUKEBOX.TRACK_ON_ADD.type, this._eTrackOnAdd);
  };

  MainScene.prototype._eTrackOnAdd = function(e) {
    var spaceship, track;
    spaceship = new SPACE.Spaceship(this.eq.center, this.eq.radius);
    this.addChild(spaceship);
    track = e.object.track;
    track.spaceship = spaceship;
    HELPERS.trigger(JUKEBOX.TRACK_ADDED, {
      track: track
    });
    this.dotted = new SPACE.DottedLine(track);
    return this.addChild(this.dotted);
  };

  MainScene.prototype._predefinedPlaylist = function() {
    this.add('https://soundcloud.com/chonch-2/courte-danse-macabre');
    this.add('https://soundcloud.com/chonch-2/mouais');
    this.add('https://soundcloud.com/huhwhatandwhere/sets/supreme-laziness-the-celestics');
    this.add('https://soundcloud.com/chonch-2/cacaco-2');
    this.add('https://soundcloud.com/chonch-2/duodenum');
    return this.add('https://soundcloud.com/chonch-2/little-green-monkey');
  };

  MainScene.prototype.draw = function() {
    return this.eq.draw();
  };

  MainScene.prototype.update = function(delta) {
    MainScene.__super__.update.apply(this, arguments);
    return this.jukebox.update(delta);
  };

  MainScene.prototype._whileplaying = function() {
    var datas, i, sound, _i;
    sound = this.jukebox.current.sound;
    datas = Array(256);
    for (i = _i = 0; _i <= 127; i = ++_i) {
      datas[i] = Math.max(sound.waveformData.left[i], sound.waveformData.right[i]);
      datas[255 - i] = Math.max(sound.waveformData.left[i], sound.waveformData.right[i]);
    }
    if (sound.paused) {
      return this.eq.mute();
    } else {
      return this.eq.setNewValues(datas);
    }
  };

  return MainScene;

})(SPACE.Scene);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjZW5lcy9tYWluLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxJQUFBOztpU0FBQTs7QUFBQSxLQUFXLENBQUM7QUFFViw4QkFBQSxDQUFBOztBQUFBLHNCQUFBLFFBQUEsR0FBVSxJQUFWLENBQUE7O0FBQUEsc0JBQ0EsT0FBQSxHQUFTLElBRFQsQ0FBQTs7QUFHYSxFQUFBLG1CQUFDLEVBQUQsR0FBQTtBQUNYLHlEQUFBLENBQUE7QUFBQSx1REFBQSxDQUFBO0FBQUEsUUFBQSxXQUFBO0FBQUEsSUFBQSwyQ0FBTSxFQUFOLENBQUEsQ0FBQTtBQUFBLElBRUEsV0FBQSxHQUFrQixJQUFBLElBQUksQ0FBQyxLQUFMLENBQVcsTUFBTSxDQUFDLFVBQVAsR0FBb0IsRUFBL0IsRUFBbUMsTUFBTSxDQUFDLFdBQVAsR0FBcUIsRUFBeEQsQ0FGbEIsQ0FBQTtBQUFBLElBSUEsSUFBQyxDQUFBLEVBQUQsR0FBVSxJQUFBLEtBQUssQ0FBQyxTQUFOLENBQWdCLFdBQWhCLEVBQTZCO0FBQUEsTUFBQyxTQUFBLEVBQVcsQ0FBWjtBQUFBLE1BQWUsU0FBQSxFQUFXLEdBQTFCO0FBQUEsTUFBK0IsTUFBQSxFQUFRLEdBQXZDO0tBQTdCLENBSlYsQ0FBQTtBQUFBLElBS0EsSUFBQyxDQUFBLFFBQUQsQ0FBVSxJQUFDLENBQUEsRUFBWCxDQUxBLENBQUE7QUFBQSxJQU9BLElBQUMsQ0FBQSxFQUFELEdBQVUsSUFBQSxLQUFLLENBQUMsVUFBTixDQUFpQixLQUFLLENBQUMsVUFBVSxDQUFDLEVBQWxDLENBUFYsQ0FBQTtBQUFBLElBV0EsSUFBQyxDQUFBLE9BQUQsQ0FBQSxDQVhBLENBQUE7QUFBQSxJQWFBLElBQUMsQ0FBQSxPQUFELEdBQWUsSUFBQSxLQUFLLENBQUMsT0FBTixDQUFBLENBYmYsQ0FBQTtBQUFBLElBY0EsSUFBQyxDQUFBLE9BQU8sQ0FBQyxZQUFULEdBQXdCLElBQUMsQ0FBQSxhQWR6QixDQURXO0VBQUEsQ0FIYjs7QUFBQSxzQkFv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QyxZQUFKLENBQWlCLEtBQWpCLEVBSEY7S0FSYTtFQUFBLENBaElmLENBQUE7O21CQUFBOztHQUY0QixLQUFLLENBQUMsTUFBcEMsQ0FBQSIsImZpbGUiOiJzY2VuZXMvbWFpbi5qcyIsInNvdXJjZVJvb3QiOiIvc291cmNlLyIsInNvdXJjZXNDb250ZW50IjpbImNsYXNzIFNQQUNFLk1haW5TY2VuZSBleHRlbmRzIFNQQUNFLlNjZW5lXG5cbiAgcGxheWxpc3Q6IG51bGxcbiAgY3VycmVudDogbnVsbFxuXG4gIGNvbnN0cnVjdG9yOiAoYmcpLT5cbiAgICBzdXBlcihiZylcblxuICAgIG1pZGRsZVBvaW50ID0gbmV3IFBJWEkuUG9pbnQod2luZG93LmlubmVyV2lkdGggKiAuNSwgd2luZG93LmlubmVySGVpZ2h0ICogLjUpXG5cbiAgICBAZXEgPSBuZXcgU1BBQ0UuRXF1YWxpemVyKG1pZGRsZVBvaW50LCB7bWluTGVuZ3RoOiAwLCBtYXhMZW5ndGg6IDIwMCwgcmFkaXVzOiAyNTB9KVxuICAgIEBhZGRDaGlsZChAZXEpXG5cbiAgICBAc2MgPSBuZXcgU1BBQ0UuU291bmRDbG91ZChTUEFDRS5TT1VORENMT1VELmlkKVxuXG4gICAgIyBAcGxheWxpc3QgPSBbXVxuICAgICMgQF9wcmVkZWZpbmVkUGxheWxpc3QoKVxuICAgIEBfZXZlbnRzKClcblxuICAgIEBqdWtlYm94ID0gbmV3IFNQQUNFLkp1a2Vib3goKVxuICAgIEBqdWtlYm94LndoaWxlcGxheWluZyA9IEBfd2hpbGVwbGF5aW5nXG5cbiAgX2V2ZW50czogLT5cbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKEpVS0VCT1guVFJBQ0tfT05fQURELnR5cGUsIEBfZVRyYWNrT25BZGQpXG5cbiAgX2VUcmFja09uQWRkOiAoZSk9PlxuICAgIHNwYWNlc2hpcCA9IG5ldyBTUEFDRS5TcGFjZXNoaXAoQGVxLmNlbnRlciwgQGVxLnJhZGl1cylcbiAgICBAYWRkQ2hpbGQoc3BhY2VzaGlwKVxuXG4gICAgdHJhY2sgPSBlLm9iamVjdC50cmFja1xuICAgIHRyYWNrLnNwYWNlc2hpcCA9IHNwYWNlc2hpcFxuICAgIEhFTFBFUlMudHJpZ2dlcihKVUtFQk9YLlRSQUNLX0FEREVELCB7IHRyYWNrOiB0cmFjayB9KVxuXG4gICAgQGRvdHRlZCA9IG5ldyBTUEFDRS5Eb3R0ZWRMaW5lKHRyYWNrKVxuICAgIEBhZGRDaGlsZChAZG90dGVkKVxuXG4gIF9wcmVkZWZpbmVkUGxheWxpc3Q6IC0+XG4gICAgQGFkZCgnaHR0cHM6Ly9zb3VuZGNsb3VkLmNvbS9jaG9uY2gtMi9jb3VydGUtZGFuc2UtbWFjYWJyZScpXG4gICAgQGFkZCgnaHR0cHM6Ly9zb3VuZGNsb3VkLmNvbS9jaG9uY2gtMi9tb3VhaXMnKVxuICAgIEBhZGQoJ2h0dHBzOi8vc291bmRjbG91ZC5jb20vaHVod2hhdGFuZHdoZXJlL3NldHMvc3VwcmVtZS1sYXppbmVzcy10aGUtY2VsZXN0aWNzJylcbiAgICBAYWRkKCdodHRwczovL3NvdW5kY2xvdWQuY29tL2Nob25jaC0yL2NhY2Fjby0yJylcbiAgICBAYWRkKCdodHRwczovL3NvdW5kY2xvdWQuY29tL2Nob25jaC0yL2R1b2RlbnVtJylcbiAgICBAYWRkKCdodHRwczovL3NvdW5kY2xvdWQuY29tL2Nob25jaC0yL2xpdHRsZS1ncmVlbi1tb25rZXknKVxuXG4gIGRyYXc6IC0+XG4gICAgQGVxLmRyYXcoKVxuXG4gIHVwZGF0ZTogKGRlbHRhKS0+XG4gICAgc3VwZXJcbiAgICBAanVrZWJveC51cGRhdGUoZGVsdGEpXG5cbiAgIyAgIGZvciB0cmFjaywgaSBpbiBAcGxheWxpc3RcbiAgIyAgICAgdHJhY2sudXBkYXRlKGRlbHRhKVxuXG4gICMgICBpZiBAcGxheWxpc3QubGVuZ3RoID4gMFxuICAjICAgICBAbmV4dCgpIGlmIEBjdXJyZW50ID09IG51bGxcblxuICAjIGFkZDogKHNvdW5kT3JQbGF5bGlzdCktPlxuICAjICAgbWlkZGxlUG9pbnQgPSBuZXcgUElYSS5Qb2ludCh3aW5kb3cuaW5uZXJXaWR0aCAqIC41LCB3aW5kb3cuaW5uZXJIZWlnaHQgKiAuNSlcblxuICAjICAgQHNjLmdldFNvdW5kT3JQbGF5bGlzdChzb3VuZE9yUGxheWxpc3QsIChvKT0+XG4gICMgICAgIHRyYWNrcyA9IG51bGxcbiAgIyAgICAgaWYgby5oYXNPd25Qcm9wZXJ0eSgndHJhY2tzJylcbiAgIyAgICAgICB0cmFja3MgPSBvLnRyYWNrc1xuICAjICAgICBlbHNlXG4gICMgICAgICAgdHJhY2tzID0gW11cbiAgIyAgICAgICB0cmFja3MucHVzaChvKVxuXG4gICMgICAgIGZvciBkYXRhIGluIHRyYWNrc1xuICAjICAgICAgICMgQ3JlYXRlIFNwYWNlc2hpcFxuICAjICAgICAgIHNwYWNlc2hpcCA9IG5ldyBTUEFDRS5TcGFjZXNoaXAobWlkZGxlUG9pbnQsIEBlcS5yYWRpdXMpXG4gICMgICAgICAgQGFkZENoaWxkKHNwYWNlc2hpcClcblxuICAjICAgICAgICMgQ3JlYXRlIHRyYWNrIGZyb20gZGF0YSBhbmQgc3BhY2VzaGlwXG4gICMgICAgICAgdHJhY2sgPSBuZXcgU1BBQ0UuVHJhY2soZGF0YSwgc3BhY2VzaGlwKVxuICAjICAgICAgIHRyYWNrLmR1cmF0aW9uQmVmb3JlTGF1bmNoaW5nID0gQGdldER1cmF0aW9uRnJvbVBvc2l0aW9uKEBwbGF5bGlzdC5sZW5ndGgtMSlcbiAgIyAgICAgICBAcGxheWxpc3QucHVzaCh0cmFjaylcblxuICAjICAgKVxuXG4gICMgZ2V0RHVyYXRpb25Gcm9tUG9zaXRpb246IChwb3NpdGlvbiktPlxuICAjICAgZHVyYXRpb24gPSAwXG4gICMgICBmb3IgdHJhY2ssIGkgaW4gQHBsYXlsaXN0XG4gICMgICAgIGR1cmF0aW9uICs9IHRyYWNrLmRhdGEuZHVyYXRpb25cbiAgIyAgICAgYnJlYWsgaWYgaSA9PSBwb3NpdGlvblxuICAjICAgcmV0dXJuIGR1cmF0aW9uXG5cbiAgIyBuZXh0OiAodHJhY2spLT5cbiAgIyAgIEBfb25maW5pc2goKSBpZiBAY3VycmVudFxuICAjICAgQGN1cnJlbnQgPSBAcGxheWxpc3Quc2hpZnQoKVxuXG4gICMgICBAc2Muc3RyZWFtU291bmQoQGN1cnJlbnQuZGF0YSwgQF9zdGFydGluZywge1xuICAjICAgICBvbnBsYXkgICAgICAgOiBAX29ucGxheVxuICAjICAgICBvbmZpbmlzaCAgICAgOiBAX29uZmluaXNoXG4gICMgICAgIG9uc3RvcCAgICAgICA6IEBfb25zdG9wXG4gICMgICAgIHdoaWxlcGxheWluZyA6IEBfd2hpbGVwbGF5aW5nXG4gICMgICB9KVxuXG4gICMgcGxheTogLT5cbiAgIyAgIGlmIEBjdXJyZW50IGFuZCBAY3VycmVudC5oYXNPd25Qcm9wZXJ0eSgnc291bmQnKVxuICAjICAgICBAY3VycmVudC5zb3VuZC5wbGF5KClcblxuICAjIHJlc3VtZTogLT5cbiAgIyAgIGlmIEBjdXJyZW50IGFuZCBAY3VycmVudC5oYXNPd25Qcm9wZXJ0eSgnc291bmQnKVxuICAjICAgICBAY3VycmVudC5zb3VuZC5yZXN1bWUoKVxuXG4gICMgcGF1c2U6IC0+XG4gICMgICBpZiBAY3VycmVudCBhbmQgQGN1cnJlbnQuaGFzT3duUHJvcGVydHkoJ3NvdW5kJylcbiAgIyAgICAgQGN1cnJlbnQuc291bmQucGF1c2UoKVxuICAjICAgICBAZXEubXV0ZSgpXG5cbiAgIyBzdG9wOiAtPlxuICAjICAgaWYgQGN1cnJlbnQgYW5kIEBjdXJyZW50Lmhhc093blByb3BlcnR5KCdzb3VuZCcpXG4gICMgICAgIEBjdXJyZW50LnNvdW5kLnN0b3AoKVxuICAjICAgICBAZXEubXV0ZSgpXG5cbiAgIyBfc3RhcnRpbmc6IChzb3VuZCk9PlxuICAjICAgQGN1cnJlbnQuc291bmQgPSBzb3VuZFxuICAjICAgZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChTUEFDRS5UcmFjay5PTl9QTEFZKCkpXG5cbiAgIyBfb25wbGF5OiA9PlxuICAjICAgY29uc29sZS5sb2cgJ29ucGxheSdcblxuICAjIF9vbmZpbmlzaDogPT5cbiAgIyAgIEBjdXJyZW50LnNvdW5kLnN0b3AoKVxuICAjICAgQGN1cnJlbnQgPSBudWxsXG4gICMgICBAZXEubXV0ZSgpXG4gICMgICBAdG1wUG9zaXRpb24gPSAwXG4gICMgICBkb2N1bWVudC5kaXNwYXRjaEV2ZW50KFNQQUNFLlRyYWNrLk9OX1NUT1AoKSlcblxuICBfd2hpbGVwbGF5aW5nOiA9PlxuICAgIHNvdW5kID0gQGp1a2Vib3guY3VycmVudC5zb3VuZFxuXG4gICAgZGF0YXMgPSBBcnJheSgyNTYpXG4gICAgZm9yIGkgaW4gWzAuLjEyN11cbiAgICAgIGRhdGFzW2ldICAgICA9IE1hdGgubWF4KHNvdW5kLndhdmVmb3JtRGF0YS5sZWZ0W2ldLCBzb3VuZC53YXZlZm9ybURhdGEucmlnaHRbaV0pXG4gICAgICBkYXRhc1syNTUtaV0gPSBNYXRoLm1heChzb3VuZC53YXZlZm9ybURhdGEubGVmdFtpXSwgc291bmQud2F2ZWZvcm1EYXRhLnJpZ2h0W2ldKVxuXG4gICAgaWYgc291bmQucGF1c2VkXG4gICAgICBAZXEubXV0ZSgpXG4gICAgZWxzZVxuICAgICAgQGVxLnNldE5ld1ZhbHVlcyhkYXRhcylcblxuIl19