var __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
  __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

SPACE.MainScene = (function(_super) {
  __extends(MainScene, _super);

  MainScene.prototype.equalizer = null;

  MainScene.prototype.jukebox = null;

  MainScene.prototype.waveformData = null;

  function MainScene() {
    this._whileplaying = __bind(this._whileplaying, this);
    this._eTrackOnAdd = __bind(this._eTrackOnAdd, this);
    var middlePoint, options;
    MainScene.__super__.constructor.apply(this, arguments);
    middlePoint = new THREE.Vector3(0, 0, 0);
    options = {
      minLength: 0,
      maxLength: 100,
      radius: 200,
      absolute: false,
      lineForceDown: .5,
      lineForceUp: 1
    };
    this.equalizer = new SPACE.Equalizer(middlePoint, options);
    this.add(this.equalizer);
    this.jukebox = new SPACE.Jukebox();
    this.jukebox.whileplaying = this._whileplaying;
    this.spaceship = new SPACE.Spaceship(middlePoint, this.equalizer.radius);
    this.add(this.spaceship);
    this.setupSomething();
    this.waveformData = {};
    this._events();
  }

  MainScene.prototype._events = function() {
    return document.addEventListener(JUKEBOX.TRACK_ON_ADD.type, this._eTrackOnAdd);
  };

  MainScene.prototype._eTrackOnAdd = function(e) {
    var track;
    track = e.object.track;
    track.spaceship = null;
    return HELPERS.trigger(JUKEBOX.TRACK_ADDED, {
      track: track
    });
  };

  MainScene.prototype.setupSomething = function() {
    var circle, g, light, m;
    g = new THREE.SphereGeometry();
    m = new THREE.MeshLambertMaterial({
      color: 0xFFAA22
    });
    circle = new THREE.Mesh(g, m);
    circle.castShadow = true;
    circle.receiveShadow = true;
    this.add(circle);
    circle.update = function() {
      this.rotation.x += .01;
      this.rotation.y -= .01;
      return this.rotation.z += .01;
    };
    light = new THREE.DirectionalLight(0xFFFFFF, 1.8 * .2);
    light.position.set(500, 500, 500);
    this.add(light);
    light = new THREE.DirectionalLight(0xFFFFFF, 1.8 * .6);
    light.position.set(-500, 500, 500);
    this.add(light);
    light = new THREE.DirectionalLight(0xFFFFFF, 1.8 * .2);
    light.position.set(500, -500, 500);
    this.add(light);
    light = new THREE.DirectionalLight(0xFFFFFF, 1.8 * .2);
    light.position.set(-500, -500, 500);
    this.add(light);
    light = new THREE.DirectionalLight(0xFFFFFF, 1.8 * .1);
    light.position.set(500, 500, -500);
    this.add(light);
    light = new THREE.DirectionalLight(0xFFFFFF, 1.8 * .1);
    light.position.set(-500, 500, -500);
    this.add(light);
    light = new THREE.DirectionalLight(0xFFFFFF, 1.8 * .1);
    light.position.set(500, -500, -500);
    this.add(light);
    light = new THREE.DirectionalLight(0xFFFFFF, 1.8 * .1);
    light.position.set(-500, -500, -500);
    return this.add(light);
  };

  MainScene.prototype.update = function(delta) {
    MainScene.__super__.update.call(this, delta);
    return this.jukebox.update(delta);
  };

  MainScene.prototype._whileplaying = function() {
    var datas, i, sound, value, _i;
    sound = this.jukebox.current.sound;
    datas = Array(256);
    for (i = _i = 0; _i <= 127; i = ++_i) {
      value = Math.max(sound.waveformData.left[i], sound.waveformData.right[i]);
      datas[i] = datas[255 - i] = value;
    }
    if (this.jukebox.current && this.jukebox.current.sound.paused) {
      this.equalizer.mute();
    } else if (this.waveformData.hasOwnProperty('mono')) {
      this.equalizer.setValues(this.waveformData.mono);
    }
    this.waveformData.mono = datas;
    return this.waveformData.stereo = sound.waveformData;
  };

  return MainScene;

})(SPACE.Scene);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRocmVlanMvc2NlbmVzL01haW4uY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLElBQUE7O2lTQUFBOztBQUFBLEtBQVcsQ0FBQztBQUVWLDhCQUFBLENBQUE7O0FBQUEsc0JBQUEsU0FBQSxHQUFXLElBQVgsQ0FBQTs7QUFBQSxzQkFDQSxPQUFBLEdBQVcsSUFEWCxDQUFBOztBQUFBLHNCQUdBLFlBQUEsR0FBYyxJQUhkLENBQUE7O0FBS2EsRUFBQSxtQkFBQSxHQUFBO0FBQ1gseURBQUEsQ0FBQTtBQUFBLHVEQUFBLENBQUE7QUFBQSxRQUFBLG9CQUFBO0FBQUEsSUFBQSw0Q0FBQSxTQUFBLENBQUEsQ0FBQTtBQUFBLElBRUEsV0FBQSxHQUFrQixJQUFBLEtBQUssQ0FBQyxPQUFOLENBQWMsQ0FBZCxFQUFpQixDQUFqQixFQUFvQixDQUFwQixDQUZsQixDQUFBO0FBQUEsSUFHQSxPQUFBLEdBQ0U7QUFBQSxNQUFBLFNBQUEsRUFBVyxDQUFYO0FBQUEsTUFDQSxTQUFBLEVBQVcsR0FEWDtBQUFBLE1BRUEsTUFBQSxFQUFRLEdBRlI7QUFBQSxNQUdBLFFBQUEsRUFBVSxLQUhWO0FBQUEsTUFJQSxhQUFBLEVBQWUsRUFKZjtBQUFBLE1BS0EsV0FBQSxFQUFhLENBTGI7S0FKRixDQUFBO0FBQUEsSUFXQSxJQUFDLENBQUEsU0FBRCxHQUFpQixJQUFBLEtBQUssQ0FBQyxTQUFOLENBQWdCLFdBQWhCLEVBQTZCLE9BQTdCLENBWGpCLENBQUE7QUFBQSxJQVlBLElBQUMsQ0FBQSxHQUFELENBQUssSUFBQyxDQUFBLFNBQU4sQ0FaQSxDQUFBO0FBQUEsSUFjQSxJQUFDLENBQUEsT0FBRCxHQUFlLElBQUEsS0FBSyxDQUFDLE9BQU4sQ0FBQSxDQWRmLENBQUE7QUFBQSxJQWVBLElBQUMsQ0FBQSxPQUFPLENBQUMsWUFBVCxHQUF3QixJQUFDLENBQUEsYUFmekIsQ0FBQTtBQUFBLElBa0JBLElBQUMsQ0FBQSxTQUFELEdBQWlCLElBQUEsS0FBSyxD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QXFCLElBQUMsQ0FBQSxPQUFPLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxNQUEvQztBQUNFLE1BQUEsSUFBQyxDQUFBLFNBQVMsQ0FBQyxJQUFYLENBQUEsQ0FBQSxDQURGO0tBQUEsTUFFSyxJQUFHLElBQUMsQ0FBQSxZQUFZLENBQUMsY0FBZCxDQUE2QixNQUE3QixDQUFIO0FBQ0gsTUFBQSxJQUFDLENBQUEsU0FBUyxDQUFDLFNBQVgsQ0FBcUIsSUFBQyxDQUFBLFlBQVksQ0FBQyxJQUFuQyxDQUFBLENBREc7S0FWTDtBQUFBLElBYUEsSUFBQyxDQUFBLFlBQVksQ0FBQyxJQUFkLEdBQXVCLEtBYnZCLENBQUE7V0FjQSxJQUFDLENBQUEsWUFBWSxDQUFDLE1BQWQsR0FBdUIsS0FBSyxDQUFDLGFBZmhCO0VBQUEsQ0EvSmYsQ0FBQTs7bUJBQUE7O0dBRjRCLEtBQUssQ0FBQyxNQUFwQyxDQUFBIiwiZmlsZSI6InRocmVlanMvc2NlbmVzL01haW4uanMiLCJzb3VyY2VSb290IjoiL3NvdXJjZS8iLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBTUEFDRS5NYWluU2NlbmUgZXh0ZW5kcyBTUEFDRS5TY2VuZVxuXG4gIGVxdWFsaXplcjogbnVsbFxuICBqdWtlYm94OiAgIG51bGxcblxuICB3YXZlZm9ybURhdGE6IG51bGxcblxuICBjb25zdHJ1Y3RvcjogLT5cbiAgICBzdXBlclxuXG4gICAgbWlkZGxlUG9pbnQgPSBuZXcgVEhSRUUuVmVjdG9yMygwLCAwLCAwKVxuICAgIG9wdGlvbnMgICAgID1cbiAgICAgIG1pbkxlbmd0aDogMFxuICAgICAgbWF4TGVuZ3RoOiAxMDBcbiAgICAgIHJhZGl1czogMjAwXG4gICAgICBhYnNvbHV0ZTogZmFsc2VcbiAgICAgIGxpbmVGb3JjZURvd246IC41XG4gICAgICBsaW5lRm9yY2VVcDogMVxuXG4gICAgQGVxdWFsaXplciA9IG5ldyBTUEFDRS5FcXVhbGl6ZXIobWlkZGxlUG9pbnQsIG9wdGlvbnMpXG4gICAgQGFkZChAZXF1YWxpemVyKVxuXG4gICAgQGp1a2Vib3ggPSBuZXcgU1BBQ0UuSnVrZWJveCgpXG4gICAgQGp1a2Vib3gud2hpbGVwbGF5aW5nID0gQF93aGlsZXBsYXlpbmdcbiAgICAjIEBqdWtlYm94LnByZWRlZmluZWRQbGF5bGlzdCgpXG5cbiAgICBAc3BhY2VzaGlwID0gbmV3IFNQQUNFLlNwYWNlc2hpcChtaWRkbGVQb2ludCwgQGVxdWFsaXplci5yYWRpdXMpXG4gICAgQGFkZChAc3BhY2VzaGlwKVxuXG4gICAgQHNldHVwU29tZXRoaW5nKClcblxuXG4gICAgQHdhdmVmb3JtRGF0YSA9IHt9XG5cbiAgICBAX2V2ZW50cygpXG5cbiAgX2V2ZW50czogLT5cbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKEpVS0VCT1guVFJBQ0tfT05fQURELnR5cGUsIEBfZVRyYWNrT25BZGQpXG5cbiAgX2VUcmFja09uQWRkOiAoZSk9PlxuICAgICMgc3BhY2VzaGlwID0gbmV3IFNQQUNFLlNwYWNlc2hpcChAZXF1YWxpemVyLmNlbnRlciwgQGVxdWFsaXplci5yYWRpdXMpXG4gICAgIyBAYWRkQ2hpbGQoc3BhY2VzaGlwKVxuXG4gICAgdHJhY2sgPSBlLm9iamVjdC50cmFja1xuICAgIHRyYWNrLnNwYWNlc2hpcCA9IG51bGwjc3BhY2VzaGlwXG4gICAgSEVMUEVSUy50cmlnZ2VyKEpVS0VCT1guVFJBQ0tfQURERUQsIHsgdHJhY2s6IHRyYWNrIH0pXG5cbiAgICAjIEBkb3R0ZWQgPSBuZXcgU1BBQ0UuRG90dGVkTGluZSh0cmFjaylcbiAgICAjIEBhZGRDaGlsZChAZG90dGVkKVxuXG4gIHNldHVwU29tZXRoaW5nOiAtPlxuICAgICMgIyBDdWJlXG4gICAgIyBnID0gbmV3IFRIUkVFLkJveEdlb21ldHJ5KDEwMCwgMTAwLCAxMDApXG4gICAgIyBtID0gbmV3IFRIUkVFLk1lc2hMYW1iZXJ0TWF0ZXJpYWwoeyBjb2xvcjogMHgwMDg4ZmYsIHNoYWRpbmc6IFRIUkVFLkZsYXRTaGFkaW5nIH0pXG4gICAgIyBAY3ViZSA9IG5ldyBUSFJFRS5NZXNoKGcsIG0pXG4gICAgIyAjIEBjdWJlLnBvc2l0aW9uLnNldFooMTAwKVxuICAgICMgQGN1YmUucm90YXRpb24uc2V0KE1hdGgucmFuZG9tKCksIE1hdGgucmFuZG9tKCksIE1hdGgucmFuZG9tKCkpXG4gICAgIyBAY3ViZS5jYXN0U2hhZG93ID0gdHJ1ZVxuICAgICMgQGN1YmUucmVjZWl2ZVNoYWRvdyA9IHRydWVcbiAgICAjIEBhZGQoQGN1YmUpXG5cbiAgICBnID0gbmV3IFRIUkVFLlNwaGVyZUdlb21ldHJ5KClcbiAgICBtID0gbmV3IFRIUkVFLk1lc2hMYW1iZXJ0TWF0ZXJpYWwoeyBjb2xvcjogMHhGRkFBMjIgfSlcbiAgICBjaXJjbGUgPSBuZXcgVEhSRUUuTWVzaChnLCBtKVxuICAgIGNpcmNsZS5jYXN0U2hhZG93ID0gdHJ1ZVxuICAgIGNpcmNsZS5yZWNlaXZlU2hhZG93ID0gdHJ1ZVxuICAgIEBhZGQoY2lyY2xlKVxuXG4gICAgY2lyY2xlLnVwZGF0ZSA9IC0+XG4gICAgICBAcm90YXRpb24ueCArPSAuMDFcbiAgICAgIEByb3RhdGlvbi55IC09IC4wMVxuICAgICAgQHJvdGF0aW9uLnogKz0gLjAxXG5cbiAgICBsaWdodCA9IG5ldyBUSFJFRS5EaXJlY3Rpb25hbExpZ2h0KCAweEZGRkZGRiwgMS44Ki4yIClcbiAgICBsaWdodC5wb3NpdGlvbi5zZXQoIDUwMCwgNTAwLCA1MDAgKVxuICAgIEBhZGQoIGxpZ2h0IClcblxuICAgIGxpZ2h0ID0gbmV3IFRIUkVFLkRpcmVjdGlvbmFsTGlnaHQoIDB4RkZGRkZGLCAxLjgqLjYgKVxuICAgIGxpZ2h0LnBvc2l0aW9uLnNldCggLTUwMCwgNTAwLCA1MDAgKVxuICAgIEBhZGQoIGxpZ2h0IClcblxuICAgIGxpZ2h0ID0gbmV3IFRIUkVFLkRpcmVjdGlvbmFsTGlnaHQoIDB4RkZGRkZGLCAxLjgqLjIgKVxuICAgIGxpZ2h0LnBvc2l0aW9uLnNldCggNTAwLCAtNTAwLCA1MDAgKVxuICAgIEBhZGQoIGxpZ2h0IClcblxuICAgIGxpZ2h0ID0gbmV3IFRIUkVFLkRpcmVjdGlvbmFsTGlnaHQoIDB4RkZGRkZGLCAxLjgqLjIgKVxuICAgIGxpZ2h0LnBvc2l0aW9uLnNldCggLTUwMCwgLTUwMCwgNTAwIClcbiAgICBAYWRkKCBsaWdodCApXG5cbiAgICBsaWdodCA9IG5ldyBUSFJFRS5EaXJlY3Rpb25hbExpZ2h0KCAweEZGRkZGRiwgMS44Ki4xIClcbiAgICBsaWdodC5wb3NpdGlvbi5zZXQoIDUwMCwgNTAwLCAtNTAwIClcbiAgICBAYWRkKCBsaWdodCApXG5cbiAgICBsaWdodCA9IG5ldyBUSFJFRS5EaXJlY3Rpb25hbExpZ2h0KCAweEZGRkZGRiwgMS44Ki4xIClcbiAgICBsaWdodC5wb3NpdGlvbi5zZXQoIC01MDAsIDUwMCwgLTUwMCApXG4gICAgQGFkZCggbGlnaHQgKVxuXG4gICAgbGlnaHQgPSBuZXcgVEhSRUUuRGlyZWN0aW9uYWxMaWdodCggMHhGRkZGRkYsIDEuOCouMSApXG4gICAgbGlnaHQucG9zaXRpb24uc2V0KCA1MDAsIC01MDAsIC01MDAgKVxuICAgIEBhZGQoIGxpZ2h0IClcblxuICAgIGxpZ2h0ID0gbmV3IFRIUkVFLkRpcmVjdGlvbmFsTGlnaHQoIDB4RkZGRkZGLCAxLjgqLjEgKVxuICAgIGxpZ2h0LnBvc2l0aW9uLnNldCggLTUwMCwgLTUwMCwgLTUwMCApXG4gICAgQGFkZCggbGlnaHQgKVxuXG4gICAgIyBsaWdodC5jYXN0U2hhZG93ID0gdHJ1ZVxuXG4gICAgIyBsaWdodC5zaGFkb3dDYW1lcmFOZWFyICAgID0gNzAwXG4gICAgIyBsaWdodC5zaGFkb3dDYW1lcmFGYXIgICAgID0gbWFuYWdlci5fY2FtZXJhLmZhclxuICAgICMgbGlnaHQuc2hhZG93Q2FtZXJhRm92ICAgICA9IDUwXG5cbiAgICAjIGxpZ2h0LnNoYWRvd0Nhc2NhZGUgPSB0cnVlXG5cbiAgICAjIGxpZ2h0LnNoYWRvd0JpYXMgICAgICAgICAgPSAwLjAwMDFcbiAgICAjIGxpZ2h0LnNoYWRvd0RhcmtuZXNzICAgICAgPSAwLjVcblxuICAgICMgbGlnaHQuc2hhZG93Q2FtZXJhUmlnaHQgICAgPSAgNVxuICAgICMgbGlnaHQuc2hhZG93Q2FtZXJhTGVmdCAgICAgPSAtNVxuICAgICMgbGlnaHQuc2hhZG93Q2FtZXJhVG9wICAgICAgPSAgNVxuICAgICMgbGlnaHQuc2hhZG93Q2FtZXJhQm90dG9tICAgPSAtNVxuXG4gICAgIyBsaWdodC5zaGFkb3dNYXBXaWR0aCAgICAgID0gMjA0OFxuICAgICMgbGlnaHQuc2hhZG93TWFwSGVpZ2h0ICAgICA9IDIwNDhcblxuXG4gICAgIyBoZWxwZXIgPSBuZXcgVEhSRUUuU3BvdExpZ2h0SGVscGVyKGxpZ2h0LCAxKVxuICAgICMgQGFkZChoZWxwZXIpXG5cbiAgICAjIHNwZWVkID1cbiAgICAjICAgeDogTWF0aC5yYW5kb20oKSAqIDAuMDA1XG4gICAgIyAgIHk6IE1hdGgucmFuZG9tKCkgKiAwLjAwNVxuICAgICMgICB6OiBNYXRoLnJhbmRvbSgpICogMC4wMDVcblxuICAgICMgQGN1YmUudXBkYXRlID0gLT5cbiAgICAjICAgQHJvdGF0aW9uLnggKz0gc3BlZWQueFxuICAgICMgICBAcm90YXRpb24ueSArPSBzcGVlZC55XG4gICAgIyAgIEByb3RhdGlvbi56ICs9IHNwZWVkLnpcblxuICB1cGRhdGU6IChkZWx0YSktPlxuICAgIHN1cGVyKGRlbHRhKVxuICAgIEBqdWtlYm94LnVwZGF0ZShkZWx0YSlcblxuICAgICMgaWYgQGp1a2Vib3guc3RhdGUgPT0gU1BBQ0UuSnVrZWJveC5JU19QTEFZSU5HXG4gICAgIyAgIGlmIEBqdWtlYm94LmN1cnJlbnQgYW5kIEBqdWtlYm94LmN1cnJlbnQuc291bmQucGF1c2VkXG4gICAgIyAgICAgQGVxdWFsaXplci5tdXRlKClcbiAgICAjICAgZWxzZSBpZiBAd2F2ZWZvcm1EYXRhLmhhc093blByb3BlcnR5KCdtb25vJylcbiAgICAjICAgICBAZXF1YWxpemVyLnNldFZhbHVlcyhAd2F2ZWZvcm1EYXRhLm1vbm8pXG5cbiAgICAgICMgaWYgIUBqdWtlYm94LmN1cnJlbnQuc291bmQuaXNQbGF5aW5nKClcbiAgICAgICMgICBAZXF1YWxpemVyLm11dGUoKVxuICAgICAgIyBlbHNlXG4gICAgICAjICAgdG1wID0gW11cbiAgICAgICMgICBmb3IgdiwgaSBpbiBAanVrZWJveC5jdXJyZW50LnNvdW5kLmdldFdhdmVmb3JtKClcbiAgICAgICMgICAgIHRtcC5wdXNoKHYpIGlmIGklOCA9PSAwXG5cbiAgICAgICMgICB2YWx1ZXMgPSBBcnJheSh0bXAubGVuZ3RoKVxuICAgICAgIyAgIGZvciBpIGluIFswLi4oKHRtcC5sZW5ndGgqLjUpLTEpXVxuICAgICAgIyAgICAgdmFsdWVzW2ldID0gdmFsdWVzW3RtcC5sZW5ndGgtMS1pXSA9IHRtcFtpXVxuXG4gICAgICAjICAgQGVxdWFsaXplci5zZXRWYWx1ZXModmFsdWVzKVxuXG4gIF93aGlsZXBsYXlpbmc6ID0+XG4gICAgc291bmQgPSBAanVrZWJveC5jdXJyZW50LnNvdW5kXG5cbiAgICBkYXRhcyA9IEFycmF5KDI1NilcbiAgICBmb3IgaSBpbiBbMC4uMTI3XVxuICAgICAgdmFsdWUgPSBNYXRoLm1heChzb3VuZC53YXZlZm9ybURhdGEubGVmdFtpXSwgc291bmQud2F2ZWZvcm1EYXRhLnJpZ2h0W2ldKVxuICAgICAgIyBkYXRhc1tpXSA9IGRhdGFzWzI1NS1pXSA9IHZhbHVlICogTWF0aC5tYXgoc291bmQucGVha0RhdGEubGVmdCwgc291bmQucGVha0RhdGEubGVmdClcbiAgICAgIGRhdGFzW2ldID0gZGF0YXNbMjU1LWldID0gdmFsdWVcblxuICAgIGlmIEBqdWtlYm94LmN1cnJlbnQgYW5kIEBqdWtlYm94LmN1cnJlbnQuc291bmQucGF1c2VkXG4gICAgICBAZXF1YWxpemVyLm11dGUoKVxuICAgIGVsc2UgaWYgQHdhdmVmb3JtRGF0YS5oYXNPd25Qcm9wZXJ0eSgnbW9ubycpXG4gICAgICBAZXF1YWxpemVyLnNldFZhbHVlcyhAd2F2ZWZvcm1EYXRhLm1vbm8pXG5cbiAgICBAd2F2ZWZvcm1EYXRhLm1vbm8gICA9IGRhdGFzXG4gICAgQHdhdmVmb3JtRGF0YS5zdGVyZW8gPSBzb3VuZC53YXZlZm9ybURhdGFcbiJdfQ==